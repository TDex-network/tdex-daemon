package wallet

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/tdex-network/tdex-daemon/pkg/explorer"
	"github.com/vulpemventures/go-elements/network"
	"github.com/vulpemventures/go-elements/pset"
)

func TestCreateAndUpdateTx(t *testing.T) {
	wallet, err := NewWalletFromMnemonic(NewWalletFromMnemonicOpts{
		SigningMnemonic:  "quarter multiply swarm depth slice security flight glad arrow express worth legend wasp mobile anchor dinner mutual six sure wear section delay initial thank",
		BlindingMnemonic: "okay door hammer betray reason zero fiction rigid vivid scorpion thunder crucial focus riot cancel wear autumn rely kangaroo rug raven mystery ability stem",
	})
	if err != nil {
		t.Fatal(err)
	}

	psetBase64, err := wallet.CreateTx()
	if err != nil {
		t.Fatal(err)
	}
	assert.Equal(t, true, len(psetBase64) > 0)

	ptx, _ := pset.NewPsetFromBase64(psetBase64)
	assert.Equal(t, 0, len(ptx.Inputs))
	assert.Equal(t, 0, len(ptx.Outputs))

	opts := UpdateTxOpts{
		PsetBase64:           psetBase64,
		Inputs:               mockUnspents(),
		InputAmount:          60000000,
		InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
		OutputAmount:         100000000000,
		OutputAsset:          network.Regtest.AssetID,
		OutputDerivationPath: "0'/0/1",
		ChangeDerivationPath: "0'/1/0",
	}

	updatedPsetBase64, selectedUnspents, err := wallet.UpdateTx(opts)
	if err != nil {
		t.Fatal(err)
	}
	assert.Equal(t, true, len(updatedPsetBase64) > 0)
	assert.Equal(t, 1, len(selectedUnspents))

	ptx, _ = pset.NewPsetFromBase64(updatedPsetBase64)
	assert.Equal(t, 1, len(ptx.Inputs))
	assert.Equal(t, 2, len(ptx.Outputs))
}

func TestFailingUpdateTx(t *testing.T) {
	wallet, err := newTestWallet()
	if err != nil {
		t.Fatal(err)
	}

	psetBase64, err := wallet.CreateTx()
	if err != nil {
		t.Fatal(err)
	}

	tests := []struct {
		opts UpdateTxOpts
		err  error
	}{
		{
			opts: UpdateTxOpts{
				PsetBase64:           "",
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrNullPset,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               []explorer.Utxo{},
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrEmptyInputs,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          0,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrZeroInputAmount,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrInvalidInputAsset,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         0,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrZeroOutputAmount,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          "",
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrInvalidOutputAsset,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "",
				ChangeDerivationPath: "0'/1/0",
			},
			err: ErrNullOutputDerivationPath,
		},
		{
			opts: UpdateTxOpts{
				PsetBase64:           psetBase64,
				Inputs:               mockUnspents(),
				InputAmount:          6000000000,
				InputAsset:           "1adcc1e8564a6f01c957a0f7fcb8badce9c126d790550e6d6817aa752369ae5f",
				OutputAmount:         100000000000,
				OutputAsset:          network.Regtest.AssetID,
				OutputDerivationPath: "0'/0/1",
				ChangeDerivationPath: "",
			},
			err: ErrNullChangeDerivationPath,
		},
	}

	for _, tt := range tests {
		_, _, err := wallet.UpdateTx(tt.opts)
		assert.Equal(t, tt.err, err)
	}
}

func mockUnspents() []explorer.Utxo {
	script, _ := hex.DecodeString("0014e12851aa15a3eea94587a6f11d818d1e7809764c")

	nonce0, _ := hex.DecodeString("02c75ccdfba5d722359b1f65686bfbf25e02dbb778823ca6979716510d6811f67e")
	surjectionproof0, _ := hex.DecodeString("010001788e56d63b93aa445e952a41d0090b04f4b48837ba3114188db4805bbcd651590a76c1e63e9638ebd9f03ae7adefabfddbf14d7a22b95a02c6e7c2097ef9a2b4")

	nonce1, _ := hex.DecodeString("02b24930f7fa092709117a73bec36dda942f5235c0cdcab76d48aca162e3eedb9c")
	surjectionproof1, _ := hex.DecodeString("02000397d6eff18da59df0723c5ac95900e4cbc7b460976ea5cf3454a7a9d98fd16b3381c928b5d75407e0fc6080928d0fc5e39bf1bbbadab7826694fa49da57f31bb97411cf37a17b2986dcb09f2541d8ed98d926e757fabb41a78752229aac63590a")

	rangeproof0, _ := hex.DecodeString("603300000000000000019e89d000c40cc1e3b0e7facd27a916295b4c8138b8e9f99daaa7efb9e0549743c036d6693928db88d903e4f95f9c345947e6126fc8dfa1c049c849b86f3281b8f2c7ddcd59cfccaa686a678ce3f25e2d3f5a083d1c577608a2fb2f61787a84d235efb3b0ec32fad96e9c8e2fc2b1e882393f48b84c7a1ecf70fe2a6a62c54ed7218372111ca9136911d7ff64dff7ce5ec8ac0aa550b460d86930a72dd0378d33f6a0d402788a57d25b23af510c9e25f52014103192d50ffe61673ea420565f479c1c21183ea99886f2ddbee8320d6cbdfdad298c3d89da55204c3ccc18c31c4c51e4c2e7e3588863e1ab1a1efac75d4c2618081d47295cf3aa35f091f05d6a4651b0dd098ab1ba65ba005db467e15c87d9aa869375d655c9dd5cc5bf45f46bc4de6aa46dfbc4e6e8aab842cc14e9534b902af1ef5b57507678b8a45c3d6d3f0d537ac16cefc284f9e63e67e014c75b712b10a257fb4e5dcf1e12109aace6852b63f62f58f9aa025e3a1c8c9b0130d3496e022b4e9b3b00f1f5b49f5e7dff3e610aa0b1c1f6dc35e27c9753f2e8d33a06cc3658d7d2cf78e7003fbac30a9e3e14f89ea981100bbd5a028618c2cf76376991a3e7e1fee5a11200e0c7296e417ba26597d2c3a0ba6aa7a49042a6ce66a73f02192b521925695742b32e40a0f18c3fb03faf10ca7ad83f3033207ccc7c96e95fe7bc988b24bf61263d1f94b6ce1a58b70e85e56de92a4d37f5a70def4437ed3d5fcdd64286baf292bac515b610f75a88a1dabe24e6ce2b1ddeb28968adbc06c9070e267c7ae297d3a327a691dea431ae91673063ae9a754934e54ada49628bc4206183aafef6006300cad542cb3a9bfe8a2b8bd79071f10254ae2c3d0388b94c2613a3dda81d2039e9aa0bd50f30cc9a4c92d7ad188ff24e19c735019f9ce65d24f624537a938a9752ffc813a38d4167f215e69ca0540ce68f6d2facc38a7a35133ce68a2cab7e40584f90a04855b4c9efc231a7066baf7540464b4465a3891c06e910d220090f5de68fe52613afa2ca3783afe2c543b328242124489bb5f82c6e804fb12bb24557213a3f21819db9d6b540560fd5fef8c7040985be1edc9ec4d2b688c92ca0e02fb61239da159cfd78c3a42ca21f4f730e67e4bcaf00f8f6b920496e3c65e52691171eb81c8fa3277a1b615ef4d0ad297c81846635c70f4e07ef8c0d24fe4d32f55070e8f74747c61d3e495af57bd3a86e8e14705da1a103ba123135d13a14e1a35851fe09a5be8ac9c8c9dfeaaf697231ae841b4d1d3e06ca3357463f1418958ec741fd075930d433a50b91eb2061a12d631907d508dacadcaedf919111d8d3ef53d182c4801d29666b915939093c94bcd3f7c459abcc0a2bffbd065879dcd2639e3cc210b51c2f4d1c401154247817e4b15310abd7a6ded639aee1ecdbd6992bf555294a63cd836cc86c32af468aa916009dd20a52958021a8ed5aae9777ce379adf0720ab1154675a17e57ac2c437d4fdbd2834b45b76dee896d6e042c91e36556621e831be9f1278888bebe16c7655e9a0ce16780d269a58b59f102969cba4b03cc0c4bbe498cb8817f6e6dc9e90437f6a22395392727acae4d9cdd52148a333e5751cebcaa5a65deda638f89e9c906d580931676f4ea130a69b890e0818e386e64183f58bd05297a2676b45108cd932a25d9c9d1f21c3e4093b10262dfa534524738d92915b0fdf03eab8d1d40d2e3095d6dc993480c195b02d414db85880f61a2524a9cee78b43b555868a2018e4c6699b9a472baadadc80e09b3c5b5acbb281f548f3b2a2d5c750dedad47e7dce268f967f8992576e42425650aa2afc9952786c2e33ef637c7325722cefa8ffefe82e8cd8e200bbe68e74ea4c3832fc9c53b3c1018a594a594649dd4e457562933bf9f5398b02ce9b4c83dbae464453b6adf1b9769f610305ea9ade690485724d2a0aa50e6fe2d48778801aaf06ef096466b65d80907c4e3606c1ee74d77c1a55fd3a9221ab529361edf4283987cd626d15f2f44b4c6febcaef740f46804b703898379ad2abfbb6c527525298acd500c9ab3e60a02aed49b9c64fa55d10796d1299bd53f34dc8c3884a1ef3ed4baa087f05f6df71f99cf890b2f61f70b7919937d0852bacecdffa7941236ca255a26105257c8dbea127108db618d80affae4bd2093bd83e64e121a8dc79dfa611e3c1987f514006ebd139e07506a896aece5a58aec1e968e1e088fc89303ab1c0142a81e0058c31bbbb31eb192e92c29590e3cfd21d21c7114507a3900ee11a7b69d9ce544a2bd29a18a241b473d31a49bdf93efe33cdc020caf0c78d5921e67e592aef9b1d825ea44f8f3915bb12f04698e6aa5b0d962b8dc58053b4642fb36ddaa6d46af54869e38184d53871b2a596bc36769b6e3cda5880017b14e9e478b8caa3b6e5c394a2e2ddfa7b713914bc1b2a6dcbe0c8094df13191c93938e8fed0ba5ba67a4add8a1e77bdebe4696b5d8bb19686baabb5a700672a6385ff3d02ce7829abbaa80fd17efdbd22227342c0473301660d1adc1d5b4d9209cca49dab3c53e52aee48fe9da4ed54d2769e5adfcb7fb2329dce64cd94ccee2a03fd519155ed272423179fb23383250e2f091aa87737f8a1690ed214cb21db41f8f3e891d8c1d31de83011ff9664ee01ca20f5875826fbff1794345ae7f712cb69fbe22a7cc8d3b23233b3cbef957cb071b9672727c0c2d443667aaf5d1bf844c9be75fc22c8ed0c951415267ef9e223e138b9f22cf349c2468560ee9db091accf741681830ece912ac6ea602140ef5a578b8f4133ca46a0fd117b9eb8327874d8ca4ef7a789e2d2c5cb4bb5caea5d359c6a0c088cb1c85695e5d3b396fa1be32e8a39f9d3a90266736a4e047bac1cad4870a7a695f9e210d167448d0b3c0d59fc2387f5a014aa689e2282aebdab51708306b2c995ff3b733358c61bc63f5874b913c939413b30d7d2b2eca08e0475db8f4636ea5ef8359d97055b8364531c47030ed3d8c68dbe5b00275a7675536486a40f3af4b368cea3a91e3b4f274f148fbd94c3a307f7151bdcbd63fe941b85e5751c4347287b567cfebc650a91700d04c0be9ea249209f2471e646a84cb8c71289771e2fc71d064b1d3a73a3274b147122e725951197ac7b999c160e76b49d5b317792e9965be9769e76337f49f35c2fc5a844bdae328daea4e26f185dc838c6028ddd573abdc4db08276a48493d80a33298e6e6ffd99f65dbcdcb9366682b2b5258d8d50fd70d1c9b64aa5e4d3ba667c1fcb5144af751efab60cf5f7d5c7a45c85d09cf8406fde9282c7ae3ce7c560fb2225dc8f614e189f4bf48a3da7e35097eda053f1db1d3649e4abdc8ff8d28bae8e278ed96228b4c554f7264b4452ff06ec2f93c9c83e2809c045ffe21f4ae23b19545ddcb6f85df2841650996d501c34a1bf78180a40a1efe2cf43cd13ca986621495b91f14f6d9e121360932ccced396ba169cebccb16f74c0a1da97456fe6cb67c96351099d161251d56b5e1c0095f43c6223741ada510a2e7b6cbcd4fa80158121389d8b49e22edf87daf4e6643ae2ce09aee2d8220616393dd3a298fb494472663020d8cc8e042c3818c155ef0de95e95c42531c8df613732f0725d71ae79a6e020da26a0946691e6e67bfdcfa8e1f8d536ab1421159fd7fb0453b07f224223b7efd8692256aa878821e397b02d0261b800d7f79429615edec22ce2224309fb5502ea81433cf16ea1ad400244c173b71ababe2e9b91b90d2e505f3c941414712f77b35c46025f7ffba92c1b90c4434408579a9060c9600432e9d6b25d0746833c3488335c8ceb6e357e93606b4f78215419a3ab36ee0ecc0f8bb38f3bdeb503db2c5483a722ebb3791bf497b2820803d4a10ce060f31de35f49e8b5611158c07c89ec6319ebecc0b5692cc4a8c1d68ec71d78c9c582462d2830cad170e027ea21f30b100aa4e7ffe16d43228a17f439e7f69a255a017102078a65dd8a9281c0ed192dbad3f8a2616f4a06267eb46a7a9c4a6baa6e1428acb302998ffc06e1dc7dc02d2f9de4546a427c773ec88754a590bc08ffc8870a23cf8ec39822c083fa44dcb17b670dd935536030d17610588c766b6b0a3de86770093327174f0bfc188769725e14ef4c33f2f97d372e5fe05c1302483b822a03636e5c987bb4fb5bc4cadcf6d94592c42ef903211753c5b5178b94a0489b7a259697a3883d85a83bc6c77eb3d09857b0bb635b520f42719a8a5de5817c52ff191b9c1d8437b343f7de97d05870a53598cbcc64cbb13f31dd4b23354d02c5e70b9a993000388d176b584426c8fd0b7e889b61154accc278f5de6073ed6a94f2ab7f7e7fdd2bd1aa7a9d9053995559117e1bda392cfb68ddd9f655536da5a357a1c03664b2b6f7bce5434e496825cbdee1681b215e01dd486b2d61bc9a4ee83fa9a5ea4b8af8bf698681d29391d320fff26fe23eae511468d3b51c53594c98ec1806ad6edac8e365725b90d47c21260aeb7f7b5155ac42229952aebb3b6cce348fc10dbf541dfa0cdc87d2819c3d1ece9affedd69b84a669ef5b5da957d85b02fecfd2b9fa80f3acbdfc5340610bc23225ac867ca34bf50243376423c352c7d0ec7aa5bb19a419b26a08d673e3c919b43d7c09519b8d7588b21c51f1c386bef5ee75a5b1f2ace10d457523975711a3056de282fc20968bf9e67c2b60fc14f9e5e6ce370fea3345de62e6d31553b2261a7f8077511b685db3d8cf4bee7821e0bc18fcd7a5bdf8f2c254982b0433c7b8002d4d718c3d32f1ed80ec2a4d6f9b5714037bffc598ae67ac75ef0fc4e4a0a60e7536cf95d6dedfa7866987f36b6fe3c77460548ea6d56da2d2d7f7157f34a736a208cad8cd27bdfd01c384d299334085927922ba78232a3ee3e46d4f47737f36acb0412b29324a995df1d1ba19532ad73e3ae3092db8db570a3dec7f5cc6b0a8fecb07c50016af964de84ea3c162a48f126ecd8511c201e29178a0cfd5a7b08955e4a1921e5466d4dbc0e19fb6e731850fc484686f7b3699ec8c208a31c71a7bd2ffba4990d7ba595f6efb6ffacad16662b4cf14ec86240c1157ea039cdff7040fb48793f0e7161a7ac08b1582a216cb7dd48ebc6826e928b4c5a8aea144d8feaad8fc56ba3cb1e01e88bc3159ae373b94c241f556ffb6b47ece7244cb25943f87f80d10f1d4ef20467fed10cca71f9f870363483b4492b73bc23d60b534f0cf3e7f5c6f3a8e9bf2ec1f95a125a357b13a362cb1a1962c4e0e9d59472878058472d564aae8425507265b8793c6ce7913947ab626266c6107cdc74c0f6375b68fea1cd32bf7257d7de783812c5350df774d690ce6e30705a114d3e8b795a31ce43cd107eb9e1aa9b0c3662432447c96cef227fbb4bbe97cbd2284f3d21ee6d8b00fa9c2c5c077d1a1584a585f9cba0d059629de61a1aa2511889384ccb34b6ad5aa0aef652202a46b3a26271c0659ae0e5740f971f51238b6271d43f8f2ae97517cbe8538067527e662d70288f9ea81eceecab60d43ec0775f6180a34a59b6dce061101b143f44d742de094a1a207b76b173b9efcb13a67aeead18fb762950e958d52ae6dd31e29fb8b8b4389ae013e7f6d805ab4d0bdbec5238490febd4130869d59afdd9ea8cab5c2fde16aa6ecfb1d8402d7eff0c822f70760a3428cc36d21bc85581ae19c4657ec601b55eef3473c44e80c70dff34d730b0a0a6a2c3c51f19da1d43b9d31f57287fcd69b090218708eead9023cdbd0046030420663897b9265a545d3daaebc71006b8b8b9e3310933ca250c183b6bd7cfca512cfd3c20eac80036b14e3dabe5b1459cc90fdeba8227b8b88bb41cdae920a245b7ab1b87c3537a60ac7a532b34dd8e117")
	rangeproof1, _ := hex.DecodeString("60330000000000000001e5cb4b01f29a0dd7400b242bf96fb6156aa72a5f6cf380c93555ba1c00fbc8f39ade68866741edef76aa981e05f59d70b3448d8a7eb3ea38a15d692dbc898d10c81067b5b43681cb66e47f5f15b7e62ea28156078212ddd9a361b6c1ac597a7cda188f4e93d9b67d20ada6b69dda64f2ccaea2e0677d49cad3df925de863cf4b6d9424c42ed96c7fa24a030101d1f5c16ce61a11c7ca18c74247553d85f82602bac164b6b0e0a02633e30c867b46e68f2788a908d9f5e038b5c237e7652d239206c78edb236b2fc49bbd0003d1a23863cf1167f1aa4bd6ccb8f5265f4745a46c6321b00169c8d7ebcb0cb2bbcc9aea1c3c5133b106a864f9114e94c0bf719eb0cf1af4addb5507c28a9340e4066993f6dcaddb23d09f96c89baf38048d1c3af00b96966fb70fc4a307421b3f854c496721dc370e9be2f44f8b64dcb4d20fb5e77e02d9af3e71b336b76fe27dd76901206c3706f3f0214d9f524eed3b982a25f2a718184e3ba1912215e83aba2f2d459f36cbb98b00946a5770eb09f673885733c9ae9016b7121d6eb64747a3b114cf2d8a9a43f6e82a14bdd5f79f4bbb62d744809edbc08e3f928558f604d0a9fc6600f699d5a0d31b2bbf8b3f93241eb455b02ec5145d57e918b0fccdc33ab82b38f9f57bef9cc87e588a6e763415316cb338217df16a68a2a697694945071a9c955524115f39fdbbafe948fa8cc16e0b6c02b80eddac05d33b4422f7f0be4cd49bf3502da1fd1c046010850afe489988a273dc1075ffe37b2d03147dfd68847640f5ea6b4c529492578b1b83dbd6f6588c37496daf9de9ce8aa27850f044e8384f7d2664465c1c132dba222d6da9d7330d6449a01451a569dca5837ee76cc8cf0065d29ee2aaef854887021b84bd4e3b4a0f2388efb35971ec94d38ad7f1b8c1f1301cab7b19301687d8f09d668cacc24e17210fa01071382e5d7097efe04c50b28d4a00c831db8f79bf9f6891cdd2b24948768ecfa9217ac04c45e8ca549f262b9f4eb7037184305074de943ac0a2d182f1ac6fdd0e12003c5829760a75c67da0c1f691644e580f3a1ccdd711ce66f148943ca03a51e03ea3c127ebb192204222318718bba69e935e5781648d2f9111484c2eadd33bc917717d3c847521f6798fb11eaf127d8b20f789d65d423360ee63f8fe03a850f68f5c3bb991d25104e2ee33afb21fd5846998f0c43c88e8e6996e18e37ba46a28c839a349c69f1ef4c18e290d54d68142eab1e9cd166b80549d951bc8d7fc64391b4a9e636289cca1c3e27289ca4ce980f1ac44695af48e2220349f3720618add5066fbce8c1183862f104bf89afe511e1b34630c1f2e56e4246f6f29d1a391e76ba8a13f3efbd4cc4aff98639eeb48da69f7630db1056df979dfba83ef7569f27d34837029007db2544be1142e8bc437ed92db78b4b12a05e1b9781c5d0b14527a0c2a7aee912310289b7e1564157e6271db9bf75dd390dceb50dee39dc3dcdb730284eb28a3d7913cc6c1de43951a7dfb42d79e6ec2054060264f45922110029394e1a31ac7a6a991b06bb0b15df625f939fb3014e18dff5f3c3dde4704887cd45688effb03cc014cc582ed6e6887bc1a9a80962b90f2abad569ff2c84e61703c23950a503d0b8dd95bcb6c1cb51412a692110fdfd2c5f4d46fd151844070c8c3f1cb867b128faae069ef8158647e71fa07899774bbaf52b190e9d6f80b59e40ea6826cfe0b700d3a21c360ee84fbba8b0c1754268650d1a40b82b5a0e6503565b4a8cb481944d161e81269d54bc8760d35ba348d4b53eb550927fbef077cbb97ff8346e92f3504981add2cbfecd844b39514d686ce9708431ddb4f067ed1c9112c31a73cfce4596fdd36832a4fa2c3eb8dbeaa5d871b52eaa369a20fcc543e07536439cfe3f05dc519e27aa6e4d9e73b9d71cb779f1224f5da3b984472d51adc24e99751da43aa7d901d9664649d05f950b350e423d1952ee4ab9a208d3abe4d1f56912cea1339a9e4d769c332e3f9aadb129aa1f4ccabe096ea73848981ca611bad776abd6d5f7c12de247c2318e68d40082286a9e6840fab1f23849443dd95b2261eeb7bcc0bb1c01354a1fdfeb75428938cbc8a7d2e9a4bfb9b2a25ceb1c2992c51ae3aaa68e3740149cf2ef8b2029503c06a21e1a4e7eac1ba659b4f51efe07b4809a5d059dad621bb4df3682edfcc0e5d927112924ae537bb2dcdab40fd0b960b02d6c64c235dddbefcb4777cc8338b1d220e89fe1e9b26e9bead72d8cb64d57ea6a3b5f1136896370f327ef859c6093ed90c40bcc9ebf353a61ff3e1c0049a76cd86d87e540e4cb09ead71dea6f7db27543affca79f7d695992419c57c3bc15c2a81e3e012a79357318b74c98fe0dee462802670ca1680e59b84c37a97a2ba8321b9a82566f53f44fa0a1fe14e243185f724539cc63bd2eb687a699a77b2a52c9a177b7e31092a1909555d8a16ecc1984d20566d56c7a12abe9b4d89d9c0e9ca10f571de37c10f1b2a8ee4173dc75c1fe5043105bc21b753aed3e08f4e8c6d4ee1fec81316d2d0bf0012c95a3ffe4b338e43e04b407fbfea5f579f451e52666d5b42cd52a39b68dc10d7c1c89600b38b7f88cd5d04df58093e6f2a71949f3df41e9f9ad3986c58e3f7082b1975363db43b159522fd6a05042026369c7cdd1a73a692396094c5934229ed0ea53f7c86233001b01baf95819639a1e5a79221cef9d8255163c30df5a8deb0d5e5611914ee0e42755ecec0078bf6decfed09ec81da65cbe44ff07eae33d3841cda1791daef24656247159dec86ed2d60e84a0b8cc5ddd7a170f27f7bf534bd0c79eab4278aa4cddcd954a3468b16a7f1aabeada96e5c709df7f2c75a263680d150e70afdf4d42358bd710c2dde9378fd8066722959ea1713384783abad501ebd5746cceb1451f70da960db84c695ca682b81c8eab6ef2860d92dc970ccb5daea5aaab4033a581211d7d437cd378a95e6fd99b675cd9398f58cce75d80d1266538578ff1ad3872cab8623640cd55f56fd27a2cb979a32d65049735d7d3e169db72da8eff0e9691dcaf91fed8e41742c2fe3992df396c5e589154b98243334bfe1d1646799e29700b3d5dfd98df9880effb2750692fb6f175832348f9fb1a6522a174b986c25d43dfe3043863a0560da5e7569022d1227ee827c5a6c6d33802f128c9822f580744e4212ccdd709a9e69be4e848f7bb47a878607b3edbed850da18d13faf643a40a7f0046e1a4abf360ac936163f3b40dd5a07e7ed915dc686a4ab446ec58d719bafbdaaa0478def7cd99313baa97434a5060a23db12c65f64ae026f58ac1ec25414f56fedcb3d1b7d30086fc6928a1461b6bce153985927b53256be3873c213a607fdba308677f839b8f7e5eaa387cc3f11258e96b59d1fce798473ccad5d23b6f9bad40df5079546e3520ae8a34e8dbf1ba75ff799aed489898bf7fa5bf70bc5375881da7d3fb3f655108393de8ee526d70749f5bae1336050d688a32ed65f2737990b1007e14a50d108c2af01ded7e92a2178b2eb18bab62bc69dc9eda2e8a891016c5c7b0584e0ea294da97d43efbda61997548da1ef738cfdc20c5cf8adbd3b0a7bf238d267cef9ad195e10b80764ffbfcd801e147cfc82e64b98515b78281673181930c2a7e30ff1b812bfae2101a3ded2491b777467005370a33bdcce3b566ae5e822841502230b9b44cee0083bf2ce498ec9a5d48880d158118878f02a44b4d6c29e55783eb2b8a90caf1f066097bba5ab744f9cb52d405f90215d44c79e35760974825d72ee62da733dbc0c90be223217c68c8402f7df5bfb71ce263c4705a59dc2358c29c7183feec51b59f4daa8fbc9a1717c4823f0a26da622b1ed5a18c951af2931dcbc8607369b2f45e35a40cb4ddca17b19efeb994cba49d055300f1b375e5440cede4d3179403f4dbfc4e0edf56441e7c1ea2beda0c3815aa917fd12f40841863d85e3545a50101273ca051c544bf594a6273cda4344f3d898f27c6de2275fdc88c34c7d8960156ded5b1302a00f881144218f48b0810346fd6a540010e0c46cf9d4e0691c3b8ded1d07b9737a9864fe62c72c98a88fc8073fa7e245a63a0d0d4baeb664cbd3e18fcec1919d02253d34061dfa8b351975551419c798cb41c1a6b65cc4689547e53a67c84047b0aef1fa88e513fde4ce809274b66fac3835fb58cf15da82559c2401e6006fef1cbfc4e90bc1f9e4a3024c5263e0db3c596b75d366ec0f356feaf2fafbe981687a7762816b4d4c1a7d81ec7608fcfab87d83c7da122749e72ec64e1f9352a846f6a5aba57f0146cca2094d9126fd96dfd91e568fcb2071d751eaa1c10ba29fb676d572c1bac9cb0b93dafc3134992b2626efa14538289c97b0dd6e4da517498ae9cb1ca0131dbb8fff1d5062b2d2003af5c183c4506a3f5fe416fc3a7a850240b4f653b482709d75734a083817ce2ac179575ddb4802fe371dbdc665198050411a4697ae74849b8931a773e692db016df8aae092b0631354011fc8f7cff550db925cf0835caa911ce560022d21bde7671f6d8c100aa1e0874130001ca514732e258cde4df68aca02e364b0d7fb0b3ecc53dc740cee19c3968d96412d6b88284e0969521c83443bb352cd4a8f429211abf15f94824a950d81ff7c81993bb1e15945d12ef8869881c015dd3ab7e139a5fedbe27624601e99fdde58c837d5bf3a2a19109a7e30770d573e6b824c6b8ca5ef70cba7e06ab29c56ea482a973f217215bdfbff76b8897698a2e24f06be067668a58a71ba6dea869f5cfa9df58d1a0b65b1e18fd1294e6262eef57c8df698592cc31cae940b844553e6e1ebe2601d33c2c9acfad5507d746e867ef2206f7fcef2b71e7209ad23a7ef9de8928adc8c5c4aca4191e7443642eac4821baf80cb470155bc0ec727c75adab892ab24a48483f7d895e2ed221980f31d0be3f69640595f552d0b9ea651cd8dfb308a7ec84e9c9b289efd9c83d769109d7a93489221c99f8a7d638d4218d2003258eac8f831fd4334b0f626881039c6f3a95efeb04789796f720a058040bafa9d88cccd42bd2009a0351e45a69480f47e8eefc1b6d3995ea41946717dcd40e801c717dfff8557435197417da05cf969854fdadaec17abfc2d011dfebaea6ad0d18b37b104dc2ba2a717498e130b4c1033e65a4f357eb9ea78a6e24fd78c41c44ef98528d59fa01d2fd3c52bbfe4adab8fa98c267928638e2f80c21bac0f466e3d40fa1c3fa9aa606ee87f28384c3a0771eb4f1ae8e69f99d67e4009f1e15bf675e518359aa3efa6b2c307c2968dc67fc0563c4beac177912923d09c1dca3e956ca89739f02608986bd5941308e2b8789e3c1b5c08aff7b0bd3890e985f05a2ae917a372bc11fd3bdbd50c1039c87ae6d4565722ed0d9331635cf2e500c19828a44f3120d7933dd51e44ee6093364de8458789c946eed8f71e59ca65958661cbc247e27b9399edc3b9dfef2339177315071653e25cb223cd83495c75443081bdc2586e1bfe78d2ded8e04e07269bc0670e53031d3d94c72f5e35e052f61c949a4207522722e756305c98fb6c662c903f07ed29d1c86c63648adba025d7d9eea49bf7394f8a838cb5b7e5ffd854598625b589079e6acfda8b29e9f6c11b424d8773f8fb7948f51528b797ee64f6e2d9afe96017e897e225951408f397b56536f735c733062abce7533dd69430af7f15dcea9d9b24f30f7de753b466b99a816d0d79c509ad2f1746c9aeacb2d11d19a55cc17954eb1a43eb3d161b60c21c3631ab1e34888da4128a5f7b14bbaac34efb7a9cad35fb3e7b2eee365cf4c04433503d37dc7c51aa77d2acb294ec2db1be7be3c6d97f71506dccdd8dd0f105f7c936")

	utxo0 := explorer.NewConfidentialWitnessUtxo(
		"b83173f53cc0b0bb6de9faa2a11f0311040e61ded5529cecdb07a8efa7aa84db", // hash
		0, // index
		"09f46d737bc6290e6303d125501924501c55ee77d127767134f9c9e2d8d6828a99", // value commitment
		"0bd6b320a165a2fe477779012d7b87c7fc1898de9f4cd3a5821957c15a7037424d", // asset commitment
		script,
		nonce0,
		rangeproof0,
		surjectionproof0,
	)
	utxo1 := explorer.NewConfidentialWitnessUtxo(
		"91255f4f9c3ce88ea256611482c87e604f4ad290b24c78bd1d4a79b97aea45f7",
		1,
		"09f2ec2ba35eaee539c13cefdcafce794573249e13aebd625140c7a2a440b2a4c3",
		"0a503773d44425bb6cb503d9612c7284ce82d161d01d3c4259ab38493d6fb77dec",
		script,
		nonce1,
		rangeproof1,
		surjectionproof1,
	)

	return []explorer.Utxo{
		utxo0,
		utxo1,
	}
}
